version: '3.8' services:
{{serviceName}}: container_name:
{{serviceName}}
build: context: . dockerfile: Dockerfile environment: - NODE_ENV={{environment}}
- PORT={{port}}
{{#if envVars}}
  {{#each envVars}}
    -
    {{@key}}={{{this}}}
  {{/each}}
{{/if}}
restart: unless-stopped
{{#if volumes}}
  volumes:
  {{#each volumes}}
    -
    {{this}}
  {{/each}}
{{/if}}
{{#if dependencies}}
  depends_on:
  {{#each dependencies}}
    -
    {{this}}
  {{/each}}
{{/if}}
expose: - "{{port}}" networks: - traefik-public labels: - "traefik.enable=true"
- "traefik.docker.network=traefik-public" - "traefik.http.routers.{{serviceName}}.rule=Host(`{{domain}}`)"
- "traefik.http.routers.{{serviceName}}.entrypoints=websecure" -
"traefik.http.routers.{{serviceName}}.tls.certresolver=letsencrypt" -
"traefik.http.services.{{serviceName}}.loadbalancer.server.port={{port}}"
healthcheck: test: ["CMD", "curl", "-f", "http://localhost:{{port}}{{healthCheckEndpoint}}"]
interval: 30s timeout: 5s retries: 3 start_period: 15s networks: traefik-public:
external: true